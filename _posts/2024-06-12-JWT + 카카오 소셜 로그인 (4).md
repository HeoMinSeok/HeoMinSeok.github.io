---
title: "JWT + ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ (4)"
date: 2024-06-12
categories: [í”„ë¡œì íŠ¸, PETSTAGRAM]
tags:
  - React
  - Spring Boot
  - JWT
  - Social Login
  - Kakao
  - OAuth2.0
---

![Login Flow Chart](/assets/img/posts/Petstagram-Project/react-springboot-social-login.png){: width="auto" height="589" }
_React + SpringBoot + Kakao ì†Œì…œ ë¡œê·¸ì¸ ë™ì‘ ê³¼ì •_

# ğŸ“Œ Client Side

## 1. ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í´ë¦­ â¡ **ì¹´ì¹´ì˜¤ ì„œë²„ì— ì¸ê°€ì½”ë“œ ìš”ì²­**

```jsx
<a href={KAKAO_AUTH_URL}>
  <img src={icons.kakaoLogin} alt="KakaoLogo" className="kakao-login-icon" />
</a>
```

```javascript
const CLIENT_ID = import.meta.env.VITE_KAKAO_CLIENT_ID;
const REDIRECT_URI = import.meta.env.VITE_KAKAO_REDIRECT_URI;

export const KAKAO_AUTH_URL = `https://kauth.kakao.com/oauth/authorize?client_id=${CLIENT_ID}&redirect_uri=${REDIRECT_URI}&response_type=code`;
```

> ğŸ° ì¹´ì¹´ì˜¤ ì„œë²„ì— ì•± í‚¤ì™€ Redirect URI, ì‘ë‹µ ìœ í˜•ì„ í¬í•¨í•˜ì—¬ ì¸ê°€ ì½”ë“œë¥¼ ìš”ì²­í•˜ëŠ”ë° ì´ ìš”ì²­ì€ ì‚¬ìš©ìê°€ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ì¸ì¦ ë° ë™ì˜ë¥¼ ì™„ë£Œí•œ í›„, ì„¤ì •ëœ Redirect URIë¡œ ì¸ê°€ ì½”ë“œë¥¼ ì „ë‹¬ë°›ê¸° ìœ„í•œ ê²ƒ

## 2. ì„¤ì •í•œ Redirect URIì¸ <span style="color: #efdb4f">/login/oauth2/callback/kakao</span> ê²½ë¡œë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜ í•˜ê¸° ìœ„í•œ KakaoCallback ì»´í¬ë„ŒíŠ¸ ë¼ìš°íŠ¸ ì„¤ì •

```jsx
<Route
  path="/login/oauth2/callback/kakao"
  element={<KakaoCallback setIsLoggedIn={setIsLoggedIn} />}
/>
```

## 3-1. ë Œë”ë§í•œ <span style="color: #efdb4f">KakaoCallback</span> ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¸ê°€ ì½”ë“œ ì¶”ì¶œ ë° ì‚¬ìš©ì ì²˜ë¦¬

> ì´ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” URLì— í¬í•¨ëœ ì¸ì¦ ì½”ë“œë¥¼ ì¶”ì¶œí•˜ì—¬ ë°±ì—”ë“œ ì„œë²„ì— ì•¡ì„¸ìŠ¤ í† í°ì„ ìš”ì²­í•˜ê³ , JWT í† í°ì„ ë°›ê²Œë˜ë©´ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê³ , ë¡œê·¸ì¸ ì²˜ë¦¬ë¥¼ ì—…ë°ì´íŠ¸ í•œ í›„ ë©”ì¸ í™ˆìœ¼ë¡œ ë„¤ë¹„ê²Œì´ì…˜í•œë‹¤.

<details>
<summary>ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```jsx
useEffect(() => {
  const fetchKakaoToken = async () => {
    const code = new URLSearchParams(location.search).get("code");
    if (code) {
      try {
        const response = await KakaoService.getAccessToken(code);
        const token = response.token;
        if (token) {
          localStorage.setItem("token", token);
          setIsLoggedIn(true);
          navigate("/");
        } else {
          console.error("ë¡œê·¸ì¸ ì‹¤íŒ¨:", response.message);
        }
      } catch (error) {
        console.error("ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì—ëŸ¬:", error);
      }
    }
  };
  fetchKakaoToken();
}, [location, navigate, setIsLoggedIn]);
```

</div>
</details>

## 3-2. ë°±ì—”ë“œ ì„œë²„ë¡œ ì¸ê°€ ì½”ë“œ ì „ë‹¬

> `KakaoService`ëŠ” ì¸ê°€ ì½”ë“œë¥¼ ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ë‹¬í•˜ì—¬ ì•¡ì„¸ìŠ¤ í† í°ì„ ìš”ì²­

<details>
<summary>ì½”ë“œ ë³´ê¸°</summary>
<div markdown="1">

```javascript
static async getAccessToken(code) {
    try {
      const response = await axios.get(
        `${KakaoService.BASE_URL}/login/kakao?code=${code}`
      );
      return response.data;
    } catch (error) {
      console.error("ë¡œê·¸ì¸ ì‹¤íŒ¨: ", error.message);
      throw new Error("ë¡œê·¸ì¸ ì‹¤íŒ¨: " + error.message);
    }
}
```

</div>
</details>
